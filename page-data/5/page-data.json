{"componentChunkName":"component---src-templates-blog-post-js","path":"/5/","result":{"data":{"site":{"siteMetadata":{"title":"Minsuh's Dev Blog"}},"markdownRemark":{"id":"101544f3-04a0-51e1-9969-60bc77c66dcc","excerpt":"스프링부트 코드를 정리하기 전에 주식 서비스 프로젝트가 어떤 식으로 이루어져 있는지 정리하는 과정이 필요해서 이 부분을 먼저 정리해보려 합니다. SKALA 과정에서 Java와 SpringBoot를 이어서 배웠기 때문에 Java…","html":"<p>스프링부트 코드를 정리하기 전에 주식 서비스 프로젝트가 어떤 식으로 이루어져 있는지 정리하는 과정이 필요해서 이 부분을 먼저 정리해보려 합니다.</p>\n<p>SKALA 과정에서 Java와 SpringBoot를 이어서 배웠기 때문에 Java 실습에서 진행했던 콘솔 주식 서비스 코드를 활용하여 SpringBoot로 옮겨서 리팩토링 하는 과정을 거쳤습니다.</p>\n<p>그래서 일단 콘솔 주식 서비스를 기반으로 서비스의 큰 구조와 기능들을 정리해보았습니다.</p>\n<h3>Java console 주식 서비스 분석</h3>\n<h4>기능 정리</h4>\n<p>우선 기본 기능들을 정리해보면 아래와 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">1. 사용자 등록\n    - 아이디를 입력 \n    - 아이디가 이미 존재하는 경우 → 해당 아이디로 로그인 됨\n    - 아이디가 없는 경우 → 초기 자금을 입력 받은 후 새 사용자 출력\n2. 보유주식 확인\n    - 남은 금액과 보유주식 확인 가능\n3. 주식 구매\n    - 주식 목록 파일에 있는 주식을 구매하는 기능\n4. 주식 판매 \n    - 내가 보유한 주식을 판매하는 기능</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이 기본 네가지 기능에 추가하여 크게 아래의 두 가지 기능을 추가했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">1. admin 기능 추가\n    - 주식 등록\n        - 새로운 주식 종목을 등록하는 기능\n    - 주식 삭제\n        - 등록된 주식 종목을 삭제하는 기능\n2. 주식 가격 갱신\n    - 특정 주기로 주식 가격을 랜덤으로 갱신 (변동 폭은 현재 주식 가격 기준으로 30% 이내)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>코드 구조 정리</h4>\n<p>SKALA 수업을 진행하며 교수님께서 주신 기본 코드를 바탕으로 기능 추가를 진행했습니다.</p>\n<p>일단 기본적인 코드의 흐름은 아래에서 확인할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0cb550ad4d7c06b40adfd1f0997a0741/49853/java_class_structure.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSUlEQVR42n1Sa28SQRTlLze20eiXFpsaP1aN+hMwqR8aBQpViVINDX0QTTS10FIWln2wz5l9zezOemZXS/kiuZkd5s6559xzp/Ly1Wt1rjHG8jzPMoF17+3+w0ebm1uPt6rb1er2zs6TjY0HtdobpDhPd5+9uLd+f21t/fnu08r5+YBzRqN0rNLxnA5nwZdvg1arfXj4AdFotmt7jWaz2en2HZKSkB33evV68+Cg3e+fVYQQtp8MFXI5IdcqPfllj7WIizzhGagsnzeOXRKJ0SzsnBpnF07MBUulQPwqPM0Ae3+kYvUoQyzcWF+EthcjPZr677pTRaMeTUjI/YCbTuT4SIksyyppJiC4c6p/H7ooFMapR7luxSTgEjyjRwMTh7gGRwBGKohSpITIKzi6mtFWT5saITgNO7bcGCQulRYitf951h2YvycEexzOF9ESjJKXCl24iUuY4zOswONGyXyjBR/7+sWNDy8VPfAC5hCG0kvm0ZT2fljqIjKd2CgCJbyCWdHDTycGTqAcGIcklpfQW3BayL5WAwDAhvAIPEv8gnmiBY6XYJMw2bYP2eaqbDDDM5ckYEMak4OEEozh1b+qWA070iwZK8yQPVSkpegTCXCW/d/K7v+0bU/OiQbcLUTdkZ0KFMaTQFfQgxU3wFAaNtFDVMRDilnGeSH7rtuMZ/CDRnI2li+rYi//Esk8tyLTjTEF005QzqfcKaxZMut2DJHQhlbhlldMq+wZTwJIy02gpXRkLjf/wMVHvp6VEH9f739SeZ7/AdIaPufnMicaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"주식 Java 클래스 구조\"\n        title=\"\"\n        src=\"/static/0cb550ad4d7c06b40adfd1f0997a0741/f058b/java_class_structure.png\"\n        srcset=\"/static/0cb550ad4d7c06b40adfd1f0997a0741/c26ae/java_class_structure.png 158w,\n/static/0cb550ad4d7c06b40adfd1f0997a0741/6bdcf/java_class_structure.png 315w,\n/static/0cb550ad4d7c06b40adfd1f0997a0741/f058b/java_class_structure.png 630w,\n/static/0cb550ad4d7c06b40adfd1f0997a0741/40601/java_class_structure.png 945w,\n/static/0cb550ad4d7c06b40adfd1f0997a0741/78612/java_class_structure.png 1260w,\n/static/0cb550ad4d7c06b40adfd1f0997a0741/49853/java_class_structure.png 2224w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>데이터의 구조를 중심으로 구조를 우선 살펴보면</p>\n<p>주식 데이터를 관리하는 Stock 클래스가 존재하고 StockRepository에서 이 Stock의 리스트를 관리하는 역할을 합니다.</p>\n<p>사용자 데이터는 Player 클래스를 활용하여 관리를 하게 되고,</p>\n<p>Stock 클래스를 상속받은 PlayerStock의 리스트를 Player 내에서 관리하여 사용자의 보유 주식을 처리할 수 있도록 했습니다.</p>\n<p>주식 데이터와 마찬가지로 PlayerRespository가 존재하고, 사용자 데이터를 관리하는 역할을 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">├── /data\n│   ├── players.txt // 사용자 데이터 저장소\n│   └── stock.txt   // 주식 데이터 저장소\n└── /src\n\t\t├── App.java    // 서비스 실행\n\t\t├── Player.java // 사용자 데이터 클래스\n\t\t├── PlayerRepository.java  // 사용자 데이터 관리\n\t\t├── PlayerStock.java // 사용자 보유 주식 데이터 클래스\n\t\t├── SkalaStockMarket.java. // 전체 서비스 UI 입출력 처리\n\t\t├── Stock.java   // 주식 데이터 클래스\n\t\t└── StockRepository.java  // 주식 데이터 관리</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이런식으로 프로젝트를 구성했습니다.</p>\n<p>Database 없이 모든 데이터를 txt 파일에 저장하고 읽어오는 방식으로 진행을 했습니다.</p>\n<h3>Java console 주식 서비스 수정과정</h3>\n<p>추가 기능을 위해 주어진 코드를 수정한 과정을 조금 정리해보고자 합니다.</p>\n<h4>Admin 기능 추가</h4>\n<p>우선 전체 서비스의 UI를 처리하는 SkalaStockMarket에서 admin 모드와 사용자 모드를 추가해주었습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>생략<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\t\n\t<span class=\"token comment\">// 프로그램 시작</span>\n\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"플레이어 ID를 입력하세요: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">String</span> playerId <span class=\"token operator\">=</span> scanner<span class=\"token punctuation\">.</span><span class=\"token function\">nextLine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token class-name\">Boolean</span> isAdmin <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>playerId<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 관리자인 경우</span>\n\t    isAdmin <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t    player <span class=\"token operator\">=</span> playerRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findPlayer</span><span class=\"token punctuation\">(</span>playerId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>player <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 새로운 플레이어</span>\n\t        player <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Player</span><span class=\"token punctuation\">(</span>playerId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"초기 투자금을 입력하세요: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t        <span class=\"token keyword\">int</span> money <span class=\"token operator\">=</span> scanner<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t        player<span class=\"token punctuation\">.</span><span class=\"token function\">setPlayerMoney</span><span class=\"token punctuation\">(</span>money<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t        playerRepository<span class=\"token punctuation\">.</span><span class=\"token function\">addPlayer</span><span class=\"token punctuation\">(</span>player<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t    <span class=\"token punctuation\">}</span>\n\t    <span class=\"token function\">displayPlayerStocks</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>isAdmin<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t    <span class=\"token function\">startAdminMode</span><span class=\"token punctuation\">(</span>scanner<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t    <span class=\"token function\">startPlayerMode</span><span class=\"token punctuation\">(</span>scanner<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>생략<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Admin 기능은 입력한 플레이어 ID가 <code class=\"language-text\">\"admin\"</code>인 경우에 작동하게 했습니다. (다른 비밀번호 확인 처리는 없는 로직을 구현했는데, 이후에 추가하면 좋을 것 같다는 생각이 들었습니다.)</p>\n<p>원래 코드는 ID를 입력 받은 후에 프로그램이 돌고 사용자 UI를 위한 부분을 <code class=\"language-text\">start()</code> 함수 내에서 모두 처리하고 있었지만 Admin을 추가하면서 함수를 분리시켜줬습니다.</p>\n<p>이런식으로 기존에 있던 사용자 모드와 비슷하게 Admin 모드 함수를 작성해줬습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token comment\">// 관리자 모드 실행</span>\n<span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">startAdminMode</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Scanner</span> scanner<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">boolean</span> running <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>running<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n=== 스칼라 주식 프로그램 관리자 메뉴 ===\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1. 주식 목록\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2. 주식 추가\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"3. 주식 삭제\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0. 프로그램 종료\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"선택: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> code <span class=\"token operator\">=</span> scanner<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        scanner<span class=\"token punctuation\">.</span><span class=\"token function\">nextLine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 개행 버퍼 삭제</span>\n\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span>\n                <span class=\"token function\">displayStockList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span>\n                <span class=\"token function\">addStock</span><span class=\"token punctuation\">(</span>scanner<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token operator\">:</span>\n                <span class=\"token function\">deleteStock</span><span class=\"token punctuation\">(</span>scanner<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token operator\">:</span>\n                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"프로그램을 종료합니다...Bye\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                running <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n                <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"올바른 번호를 선택하세요.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>개행 버퍼 삭제하기</p>\n</blockquote>\n<p>이 코드를 작성하면서 유의해야할 점은 입력값을 받을 때, 개행 문자 처리를 해줘야하는 것이었습니다.</p>\n<p>메뉴 선택 입력을 nextInt()로 받는 경우에 입력할 때 enter키를 치게 되면 입력한 숫자는 code 변수에 저장되고, 개행문자(\\n)는 입력 버퍼에 남아있게 됩니다.</p>\n<p>이때, addStock()과 같은 함수에서 새로운 주식 이름과 가격을 nextLine()을 활용하여 입력받게 되는데, 이때 버퍼에 남아있던 개행 문자 때문에 입력을 제대로 받지 못하는 문제가 생겼습니다. 이를 방지하기 위해 int값을 받은 후에 nextLine()을 한 번 호출하여 개행 문자를 버퍼에서 삭제해줄 수 있도록 했습니다.</p>\n<p>관리자 기능을 추가하면서 가장 고려했던 사항은 각 클래스에 관련 함수를 추가하면서 확실히 각각의 기능을 분리하는 것이었습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">- SkalaStockMarket: 콘솔 UI 관련한 내용 처리\n- StockRepository: 데이터를 파일에 저장 및 읽어오는 함수들 관리\n- Stock: 데이터 클래스 역할</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>이런 식으로 구분을 하고, 역할을 계속 염두에 두며 코드를 작성했습니다.</p>\n<h4>주식 가격 실시간 업데이트 기능 추가</h4>\n<p>Timer와 TimerTask를 활용하여 해당 기능을 추가해줬습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>생략<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\t\n\t<span class=\"token comment\">// 가격 변동 업데이트 위한 타이머</span>\n  <span class=\"token class-name\">Timer</span> timer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Timer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token class-name\">TimerTask</span> task <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TimerTask</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token annotation punctuation\">@Override</span>\n      <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          stockRepository<span class=\"token punctuation\">.</span><span class=\"token function\">changeRandomStockPrice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          stockRepository<span class=\"token punctuation\">.</span><span class=\"token function\">saveStock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  \n  timer<span class=\"token punctuation\">.</span><span class=\"token function\">scheduleAtFixedRate</span><span class=\"token punctuation\">(</span>task<span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>생략<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  \n  timer<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이런식으로 <code class=\"language-text\">start()</code> 함수에 타이머를 설정하여 프로그램이 실행되는 동안 특정시간 주기로 주식 가격을 업데이트 할 수 있도록 했습니다.</p>\n<p>우선 새 <code class=\"language-text\">Timer</code> 객체를 정의하고 주기적으로 실행하고 싶은 task를 <code class=\"language-text\">TimerTask</code> 객체로 만들어줍니다.</p>\n<p>이후 이 task를 <code class=\"language-text\">scheduleAtFixedRate()</code>에 넘겨주면 해당 task를 설정한 주기마다 실행할 수 있게 됩니다.</p>\n<p>새로운 주식 가격을 설정하는 함수는 아래와 같이 구성했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token comment\">// stock 가격 random update</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> changeRandomStockPrice <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Stock</span> stock<span class=\"token operator\">:</span> stockList<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">double</span> percent <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.3</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// -0.3 ~ 0.3</span>\n        <span class=\"token class-name\">BigDecimal</span> total <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BigDecimal</span><span class=\"token punctuation\">(</span>stock<span class=\"token punctuation\">.</span><span class=\"token function\">getStockPrice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>stock<span class=\"token punctuation\">.</span><span class=\"token function\">getStockPrice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> percent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">RoundingMode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DOWN</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        stock<span class=\"token punctuation\">.</span><span class=\"token function\">setStockPrice</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Double</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseDouble</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%.2f\"</span><span class=\"token punctuation\">,</span> total<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>double 자료형 처리</p>\n</blockquote>\n<p>여기서 문제가 되었던 부분은 double 자료형 관련하여 처리를 해주어야 했던 부분입니다.</p>\n<p>주식의 가격을 double 자료형으로 정의하고 진행을 하였는데 이 과정을 진행하며 주식 가격의 소수점 아래의 형태가 아래와 같이 나타나는 문제가 발생했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">실제 원하는 값: 0.1\ndouble 값: 0.10000000000000002</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>컴퓨터 내에서 실수를 이진수를 표현하는 과정에서 부동소수점 오차가 발생하여 이러한 현상이 발생하게 됩니다.</p>\n<p>이 부분을 해결할 수 있는 부분은 여러가지가 있는데,</p>\n<p>저는 다음과 같은 방법으로 진행했습니다.</p>\n<ul>\n<li>연산을 할 때에는  BigDecimal을 이용하여 계산 결과에서 오차가 발생하지 않도록 진행</li>\n<li>저장시에는 String으로 변환하여 포맷을 맞춰준 후 저장 (Stock 함수의 필드값의 자료형을 변경하지 않기 위해서 파일에 저장할 때에도 string 포맷을 한 번 맞춰주는 과정을 추가)</li>\n</ul>\n<p>그런데 지금 정리를 하면서 돌아보니 Stock 함수의 필드값의 자료형 자체를 BigDecimal로 수정하는 방안이 더 정확한 연산을 진행할 수 있는 방안이라는 생각이드네요….</p>\n<p>아무튼 이후 SpringBoot로 해당 프로젝트를 수정하는 과정에서는 조금 더 쉬운 관리를 위해서 int형으로 자료형을 수정해서 진행하였습니다.</p>\n<h3>정리</h3>\n<p>그래서 정리를 해보면 위의 Java 코드에 있는 아래 기능들을 바탕으로</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">- 사용자 관련 기능\n    - 사용자 등록\n    - 사용자 삭제\n    - 사용자 조회\n    - 주식 구매\n    - 주식 판매\n- 주식 관련 기능\n    - 주식 등록\n    - 주식 삭제\n    - 주식 조회</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>SpringBoot 프로젝트에서 각 기능을 하는 API를 만들어보고자 합니다.</p>","frontmatter":{"title":"[SpringBoot] 스프링부트 프로젝트 시작하기 - 2","date":"March 15, 2025","description":"주식 서비스 프로젝트 구조화"},"fields":{"slug":"/5/"},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#java-console-%EC%A3%BC%EC%8B%9D-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%B6%84%EC%84%9D\">Java console 주식 서비스 분석</a></p>\n<ul>\n<li><a href=\"#%EA%B8%B0%EB%8A%A5-%EC%A0%95%EB%A6%AC\">기능 정리</a></li>\n<li><a href=\"#%EC%BD%94%EB%93%9C-%EA%B5%AC%EC%A1%B0-%EC%A0%95%EB%A6%AC\">코드 구조 정리</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#java-console-%EC%A3%BC%EC%8B%9D-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%88%98%EC%A0%95%EA%B3%BC%EC%A0%95\">Java console 주식 서비스 수정과정</a></p>\n<ul>\n<li><a href=\"#admin-%EA%B8%B0%EB%8A%A5-%EC%B6%94%EA%B0%80\">Admin 기능 추가</a></li>\n<li><a href=\"#%EC%A3%BC%EC%8B%9D-%EA%B0%80%EA%B2%A9-%EC%8B%A4%EC%8B%9C%EA%B0%84-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EA%B8%B0%EB%8A%A5-%EC%B6%94%EA%B0%80\">주식 가격 실시간 업데이트 기능 추가</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%95%EB%A6%AC\">정리</a></p>\n</li>\n</ul>"},"previous":{"fields":{"slug":"/4/"},"frontmatter":{"title":"[SKALA] SKALA 2월 회고"}},"next":null},"pageContext":{"id":"101544f3-04a0-51e1-9969-60bc77c66dcc","previousPostId":"50af8ade-fc50-5871-a1ed-17aae57218c3","nextPostId":null}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}